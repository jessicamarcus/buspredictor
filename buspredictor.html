<!DOCTYPE html>
<html>
<head>
    <title>Personal Bus Predictor</title>
    <meta content="width=device-width,initial-scale=1.0" name="viewport">
    <link type="text/css" rel="stylesheet" href="./buspredictor.css" />

</head>
<body>
<h1>Personal Bus Predictor</h1>
<button type="button" onclick="LoadViewModel('./89davis.xml')">89 to Davis</button>
<button type="button" onclick="LoadViewModel('./89sullivan.xml')">89 to Sullivan</button>
<button type="button" onclick="LoadViewModel('./101sullivan.xml')">101 to Sullivan</button>
<button type="button" data-bind="click: refresh">Refresh Predictions</button>


<div class="ddl">
    <select id="ddl_agencies" data-bind="options: allAgencies, value: selectedAgency, optionsText: 'title', optionsCaption: 'Please select a transit agency:'"></select>
</div>

<div class="ddl" data-bind="visible: selectedAgency, with: selectedAgency">
    <select id="ddl_routes" data-bind="options: routes, optionsText: 'title', optionsCaption: 'Please select a route:'">
    </select>
</div>

<span data-bind="text: selectedAgency() ? selectedAgency().title : 'no title'"></span>
<span data-bind="text: selectedAgency() ? selectedAgency().routes().tag : 'no tag'"></span>


<div data-bind="foreach: selectedPredictions">
    <div class="prediction">
        <p><span data-bind="text: agencyTitle" class="title"></span> <span class="title">Route </span>
        <span data-bind="text: routeTitle" class="title"></span> <br />
        Stop: <span data-bind="text: stopTitle"></span></p>
        <div data-bind="foreach: directions">
            <span data-bind="text: title" class="directionTitle"></span><br />
            <span data-bind="foreach: predictions">
                <div data-bind="css: {delayedBus: delayed() === 'true'}" class="displayedPrediction">
                    <span data-bind="text: minutes"></span> minutes away / arrives at <span data-bind="text: epochTime"></span><br />
                </div>
            </span>
        </div>
        <div class="removePrediction"><a href="#" data-bind="click: $root.removeRoutePrediction">Remove prediction</a></div>
    </div>
</div>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.10.2.min.js"></script>
<script type="text/javascript" src="http://ajax.aspnetcdn.com/ajax/knockout/knockout-3.0.0.js"></script>
<script type="text/javascript" src="./buspredictor.js"></script>
<script type="text/javascript" src="./utc_handlers.js"></script>
</body>
</html>